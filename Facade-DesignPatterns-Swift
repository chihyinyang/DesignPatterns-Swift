### FaÃ§ade /fÉ™ËˆsÉ‘Ëd/

1. å»ºç¯‰ç‰©æ­£é¢
2. å‡è±¡ï¼Œè™›å‡çš„å¤–è¡¨

### å®šç¾©

å°‡åœ¨å„è™•çš„APIæ•´åˆèµ·ä¾†ï¼Œç°¡åŒ–ä¸€èˆ¬éœ€è¦é€£çºŒåŸ·è¡Œå¤šå€‹APIçš„è¡Œç‚ºã€‚

### ç¯„ä¾‹

```swift
// å¯¶è—åœ°åœ–
class TreasureMap {
		// å¾—åˆ°ç å¯¶å¯¶è—çš„ç¶“ç·¯åº¦
		func getJewelsCoordinate() -> (lat, lng)
		// å¾—åˆ°é»ƒé‡‘å¯¶è—çš„ç¶“ç·¯åº¦m km
		func getGoldCoordinate() -> (lat, lng)
}

// èˆ¹
class Ship {
		// è®“èˆ¹ç§»å‹•è‡³ä½ç½®
		func moveToLocation(coordinate: Coordinate, completion: () -> Void)
}

// èˆ¹å“¡
class Crew {

		Enum Action {
				case .jewel
				case .gold
		}

		// åŸ·è¡Œæ‰¾å°‹å¯¶è—çš„è¡Œç‚º
		func perforAction(action: Action, completion: () -> Void)
}

// FaÃ§ade
class Facade {

	private let map = TreasureMap()
	private let ship = Ship()
	private let crew = Crew()
		

// closure 
	func digForGold() {
				let coordinate = map.getGoldCoordinate()
				ship.moveToLocation(coordinate: coordinate) {
						crew.perforAction(action: .gold) {
							print("æŒ–åˆ°é»ƒé‡‘ï¼")
						}
				}
		}

// GCD
	func searchForJewel() {
				let semaphore = dispatch_semaphore_create(0)
				let coordinate = map.getJewelsCoordinate()
				ship.moveToLocation(coordinate: coordinate) {
						dispatch_semaphore_signal(semaphore)
				}
				
				dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER)
				crew.performAction(action: .jewel) {
						print("æ‰¾åˆ°ç å¯¶")
				}
		}
}
			

// client
let facade = Facade()
facade.searchForJewel()
facade.digForGold()
```

![229206011049091.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9751beb9-0b03-4489-bd54-9701099028cd/229206011049091.png)

### âš ï¸æ³¨æ„ - é€æ˜åº¦

åœ¨å¯¦ä½œFaÃ§adeæ¨¡å¼çš„æ™‚å€™ï¼Œæœƒæœ‰æ´©æ¼åº•å±¤ç‰©ä»¶ç´°ç¯€çš„é™·é˜±ï¼Œç¨±ç‚ºé€æ˜åº¦ã€‚æ³¨æ„ï¼Œåœ¨å»ºç«‹FaÃ§adeçš„æ™‚å€™å°±è¦æ±ºå®šä»–æ˜¯å¦ç‚ºé€æ˜ã€‚ä¸”ï¼Œä¸æ‡‰è©²å› ç‚ºå°‡ä¾†å¯èƒ½æœ‰æ©Ÿæœƒï¼Œè¦ä¿®æ”¹åŸä¾†çš„codeå°‡ä¸é€æ˜â†’é€æ˜ï¼Œè€Œä¸€é–‹å§‹éƒ½å»ºç«‹ç‚ºé€æ˜çš„ã€‚

```swift
// FaÃ§ade
class Facade {
	// ç§»é™¤privateï¼Œè®“å¤–é¢çš„äººå¯ä»¥ç›´æ¥å–ç”¨è£¡é¢çš„æ±è¥¿
	~~private~~ let map = TreasureMap()
	~~private~~ let ship = Ship()
	~~private~~ let crew = Crew()
```

### æ¯”è¼ƒ

æ•´åˆå–®ä¸€å…ƒä»¶æ™‚ï¼Œä¸éœ€è¦ä½¿ç”¨FaÃ§adeæ¨¡å¼ï¼Œæ”¹ç”¨adapter

### å„ªé»

1.  æé«˜äº†éˆæ´»æ€§ã€‚ 
2. æé«˜äº†å®‰å…¨æ€§ã€‚

### ç¼ºé»

1. ä¸ç¬¦åˆé–‹é–‰åŸå‰‡ï¼Œå¦‚æœè¦æ”¹æ±è¥¿å¾ˆéº»ç…©ï¼Œç¹¼æ‰¿æˆ–æ˜¯é‡å¯«éƒ½ä¸åˆé©

### **ä½¿ç”¨åœºæ™¯**

1. ç‚ºè¤‡é›œçš„æ¨¡çµ„æˆ–æ˜¯é¡åˆ¥ç³»çµ±æä¾›å¤–ç•Œè¨ªå•
2. é é˜²ä½æ°´å¹³äººå“¡å¸¶ä¾†çš„é¢¨éšªğŸ¤£

### Reference

[DispatchSemaphore](https://developer.apple.com/documentation/dispatch/dispatchsemaphore)

[https://www.jianshu.com/p/8e55a23fedec](https://www.jianshu.com/p/8e55a23fedec)
